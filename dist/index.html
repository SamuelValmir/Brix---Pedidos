<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js"></script>

    <title>Pedidos</title>
</head>

<body>
    <!-- <form action="http://192.168.100.20:9999/file/post" method="post" enctype="multipart/form-data"> -->
        <input type="file"
        accept=".xlsx, .xlsm, .xlsb, .xlsb, .xlsx, .xltx, .xltm, .xls, .xlt, .xml, .xlam, .xla, .xlw, .xlr" id="file" name="formattedTable">
        <button onclick="sendFile()">Enviar Planilha</button>
        <!-- <button type="submit">Enviar Planilha</button> -->
    <!-- </form> -->

    <div class="div">
        <table>
        </table>
    </div>

    <div style="display:none">

        Gerar manualmente

        Gerar automaticamente
        A geração automática vai selecionar, como elementos, da coluna A à coluna F incluindo a coluna L (estado CE),
        a partir da linha 7 (Linhas vazias são consideradas como inexistente: Exemplo:(Em uma tabela com 4 linhas se a
        linha
        2 estiver vazia, a primeira linha será a 1, a segunda a 3 e a terceira a 4 ))
        Deseja manter essas configurações?
        Manter Mudar configurações de geração

        Gerando
    </div>


    <script>
        const inputFile = document.querySelector("#file");
        const file = inputFile.files[0];
        const formData = new FormData();
        formData.append("tabela", file);

        const div = document.querySelector(".div");
        const table = document.querySelector("table");
        const tableBody = document.createElement("tbody");

        // table.appendChild(tableBody);
        // inputFile.addEventListener("change", () => {
        // console.log(inputFile.files[0])
        // readXlsxFile(inputFile.files[0]).
        //     then((rows) => {

        //         rows.forEach((row, index) => {
        //             if (index >= 6) {
        //                 const rowElement = document.createElement("tr");

        //                 row.forEach((cell, index) => {
        //                     if (index < 6 || index === 11) {

        //                         const cellElement = document.createElement("td");
        //                         cellElement.innerText = cell;
        //                         rowElement.appendChild(cellElement);
        //                     }
        //                 })

        //                 tableBody.appendChild(rowElement);
        //             }
        //         });

        //     })
        // });


        // function getFile() {

        //     fetch("http://192.168.100.20:9999/file/get", { method: "GET" })
        //         // .then(response=>response.body.getReader())
        //         .then(data => {
        //             console.log(data)
        //         })
        // }


        function sendFile() {
            const inputFile = document.querySelector("#file");
            const file = inputFile.files[0];
            console.log(file)
            const formData = new FormData();
            formData.append("inputtedTable", file);

            fetch("http://192.168.100.20:9999/file/post?a=123", {
                method: "POST",
                // headers: {"Content-Type": "multipart/form-data", "boundary": "----WebKitFormBoundaryKkKASB0dr15NjVIx"},
                body: formData
            })
            // .then(request => request.body)
            // .then(json => {
            //     console.log(json);
            // })
        };
    </script>
</body>

</html>